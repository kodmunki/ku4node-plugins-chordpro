var $kernel = require('ku4node-kernel'),
    $ = $kernel.asserters,
    $hash = $kernel.collections.hash,
    $dto = require('../src/dto'),
    dto1 = $dto({"one":1, "two":2, "three":3}),
    dto2 = $dto($hash({"one":1, "two":2, "three":3})),
    dto3 = $dto($dto({"one":1, "two":2, "three":3}));

exports['methods'] = function (test) {
    test.expect(8);
    var rep1 = dto1.replicate().add("new", "new"),
        rep2 = dto2.replicate().add("new", "new"),
        rep3 = dto3.replicate().add("new", "new");

    test.equal(3, dto1.count(), "replicate");
    test.equal(3, dto2.count(), "replicate");
    test.equal(3, dto3.count(), "replicate");

    test.equal(4, rep1.count(), "replicate");
    test.equal(4, rep2.count(), "replicate");
    test.equal(4, rep3.count(), "replicate");

    test.ok(!dto1.containsKey("new"));
    test.ok(rep1.containsKey("new"));
    test.done();
};